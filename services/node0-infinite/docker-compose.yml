services:
  infinite:
    # Core service settings (image, name, user, restart) - not expected to be modified by users
    image: deepthoughtlabs/infinite-drive:latest
    container_name: infinite
    # User configuration: Uses environment variables PUID and PGID if set, otherwise defaults to 1000:1000
    # To fix permission issues, set these before running docker-compose:
    #   Without sudo: export PUID=$(id -u) && export PGID=$(id -g)
    #   With sudo:    export PUID=${SUDO_UID:-$(id -u)} && export PGID=${SUDO_GID:-$(id -g)}
    # Or run inline: PUID=$(id -u) PGID=$(id -g) docker-compose up -d
    # Note: Works with or without sudo - if using sudo, it will use SUDO_UID/SUDO_GID automatically
    user: "${PUID:-1000}:${PGID:-1000}"
    restart: unless-stopped

    ##################################################################################
    #                       Editable Section Starts Here                             #
    # Customize ports, volumes, and environment variables as needed below.           #
    ##################################################################################

    ports:
      # See ../../config/ports/strategy.md for port allocation strategy and conflict resolution
      # See ../../config/ports/services/node0-infinite.md for complete port configuration
      # Required ports
      - "26656:26656"  # P2P
      - "26657:26657"  # RPC
      
      # Optional ports (uncomment if needed)
      # - "9090:9090"    # gRPC
      # - "9091:9091"    # gRPC-Web
      # - "1317:1317"    # REST API
      # - "8545:8545"    # JSON-RPC HTTP
      # - "8546:8546"    # JSON-RPC WebSocket
      # - "26660:26660"  # Prometheus
      # - "6065:6065"    # EVM Metrics
      # - "8100:8100"    # Geth Metrics
    
    volumes:
      - ./persistent-data:/home/ubuntu/.infinited

    environment:
      # For complete documentation of all environment variables, see: ../../config/environment/reference.md
      # For port allocation and configuration, see: ../../config/ports/strategy.md

      ##################################################################################
      #                           Chain Identification                                 #
      ##################################################################################
      NODE_CHAIN_ID: "infinite_421018-1"
      NODE_EVM_CHAIN_ID: "421018"
      NODE_GENESIS_URL: "https://raw.githubusercontent.com/deep-thought-labs/infinite/migration/assets/pre-mainet-genesis.json"

      ##################################################################################
      #                           Network P2P Configuration                            #
      ##################################################################################
      NODE_P2P_SEEDS: "71a48afac2463a77bc5825d78dd83299174c4a6c@66.70.178.128:26656"
      # NODE_PERSISTENT_PEERS: ""
      # NODE_P2P_EXTERNAL_ADDRESS: "" 

    ### End environment variables
  ### End service infinite
### End docker-compose.yml