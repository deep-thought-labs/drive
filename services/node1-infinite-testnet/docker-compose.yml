services:
  infinite-testnet:
    # Core service settings (build, name, user, restart) - Testing with local build
    # This builds the image locally from the Dockerfile in dev/ directory
    # Build context: From services/node1-infinite-testnet/, go up three levels (../../../) to project root, then into dev/
    build:
      context: ../../../dev
      dockerfile: Dockerfile
    image: infinite-drive:testnet-local
    container_name: infinite-testnet
    restart: unless-stopped
    # Note: Container runs as user 1000:1000 (set in Dockerfile), no need for user: directive

    ##################################################################################
    #                       Editable Section Starts Here                             #
    # Customize ports, volumes, and environment variables as needed below.           #
    ##################################################################################

    ports:
      # See ../../config/ports/strategy.md for port allocation strategy and conflict resolution
      # See ../../config/ports/services/node1-infinite-testnet.md for complete port configuration
      # Required ports
      - "26666:26656"  # P2P
      - "26667:26657"  # RPC
      
      # Optional ports (uncomment if needed)
      # - "9100:9090"    # gRPC
      # - "9101:9091"    # gRPC-Web
      # - "1327:1317"    # REST API
      # - "8555:8545"    # JSON-RPC HTTP
      # - "8556:8546"    # JSON-RPC WebSocket
      # - "26670:26660"  # Prometheus
      # - "6075:6065"    # EVM Metrics
      # - "8110:8100"    # Geth Metrics
    
    volumes:
      - ./persistent-data:/home/ubuntu/.infinited

    environment:
      # For complete documentation of all environment variables, see: ../../config/environment/reference.md
      # For port allocation and configuration, see: ../../config/ports/strategy.md

      ##################################################################################
      #                           Chain Identification                                 #
      ##################################################################################
      NODE_CHAIN_ID: "infinite_421018001-1"
      NODE_EVM_CHAIN_ID: "421018001"
      NODE_GENESIS_URL: "https://raw.githubusercontent.com/deep-thought-labs/drive/refs/heads/main/services/node1-infinite-testnet/genesis.json"

      ##################################################################################
      #                           Network P2P Configuration                            #
      ##################################################################################
      NODE_P2P_SEEDS: "88ec87026e7b61eceeca0d74cf47a24cea36642b@66.70.178.128:26666"
      # NODE_PERSISTENT_PEERS: ""
      # NODE_P2P_EXTERNAL_ADDRESS: "" 

    ### End environment variables
  ### End service infinite-testnet
### End docker-compose.yml

